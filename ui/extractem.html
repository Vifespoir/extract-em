<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>__MSG_extensionName__</title>
    <link rel="icon" type="image/x-icon" href="/icons/extractem-32px.ico">
    <link rel="stylesheet" type="text/css" media="screen" href="extractem.css">
</head>

<body>
    <div id="flex-container">
        <section id="quickmenu-section" class="hidden">
            <div id="quickmenu-extract-single-div">
                <button type="button" class="quickmenu-button" action="extract-single">__MSG_extensionName__</button>
                __MSG_extractSingleDescription__
            </div>
            <div id="quickmenu-extract-recursive-div" class="hidden">
                <button type="button" class="quickmenu-button" action="extract-recursive">__MSG_extensionName__<br/>(+ __MSG_subfolders__)</button>
                __MSG_extractRecursiveDescription__
            </div>
            <div>
                <button type="button" class="quickmenu-button" action="standard-selection">__MSG_letMeChoose__</button>
                __MSG_standardSelectionDescription__
            </div>
            <label id="quickmenu-option-label" class="hidden"><input type="checkbox" id="always-show-quickmenu-checkbox"/> __MSG_alwaysShowQuickMenu__</label>
        </section>
        <section id="main-section" class="hidden">
            <nav>
                <button type="button" class="nav-button active" context="summary">__MSG_attachmentSummary__</button>
                <button type="button" class="nav-button invisible" context="list" disabled="disabled">__MSG_attachmentList__</button>
                <div id="spinner-logo-div" class="spinner-logo-div">
                    <img id="logo-img" class="logo-img" src="paperclip_logo.png" />
                </div>
            </nav>
            <div class="tab-content-div" context="summary">
                <div>
                    <table id="stats-table">
                        <colgroup>
                            <col span="2" class="folders-column">
                            <col span="3" class="messages-column">
                            <col span="2" class="attachments-column">
                        </colgroup>
                        <thead>
                            <tr>
                                <th colspan="2" class="summary-header">__MSG_folders__</th>
                                <th colspan="3" class="summary-header">__MSG_messages__</th>
                                <th colspan="2"  class="summary-header">__MSG_attachments__</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="2"><span id="selected-folder-count-span">0</span> / <span id="folder-count-span"></span> __MSG_selected__</td>
                                <td colspan="3"><span id="summary-selected-message-count-span">0</span> __MSG_selected__</td>
                                <td colspan="2"><span id="summary-selected-attachment-count-span">0</span> __MSG_selected__<br/><span id="summary-selected-attachment-size-span">0 __MSG_bytesLabel__</span></td>
                            </tr>
                            <tr>
                                <td colspan="2"><br/></td>

                                <td class="summary-header">__MSG_count__</td>
                                <td class="summary-header">__MSG_processed__</td>
                                <td id="with-attachments-label" class="summary-header">__MSG_withAbbrev__<img id="paperclip_char" src="/icons/paper_clip.png" height="20px" width="20px"></td>

                                <td class="summary-header">__MSG_count__</td>
                                <td class="summary-header">__MSG_size__</td>
                            </tr>
                            <tr id="stats-summary-tr" class="hidden">
                                <td colspan="2"><br/></td>

                                <td id="summary-message-count-span">0</td>
                                <td id="summary-processed-message-count-td">0</td>
                                <td id="summary-attachment-message-count-td">0</td>
                                
                                <td id="summary-attachment-count-span">0</td>
                                <td id="summary-attachment-size-span">0 __MSG_bytesLabel__</td>
                            </tr>
                        </tbody>
                        <tbody id="stats-summary-tbody">

                        </tbody>
                        <tfoot>
                            <th colspan="2"></th>
                            <th colspan="3"></th>
                            <th colspan="2"></th>
                        </tfoot>
                    </table>
                </div>
                <div id="summary-buttons-div">
                    <div>
                        <button type="button" id="discover-attachments-button" class="summary-button">__MSG_discoverAttachments__</button>
                        <progress id="discover-attachments-progress" max="1" value="0"></progress>
                    </div>                    
                    <button type="button" id="extract-all-button" class="summary-button" disabled="disabled">__MSG_extensionName__</button>
                    <button type="button" id="reset-summary-button" class="summary-button">__MSG_reset__</button>
                </div>
            </div>
            <div class="tab-content-div hidden" context="list">
                <div id="list-header-div">
                    <div><span id="selected-attachment-count-span">0</span> __MSG_selected__ (<span id="selected-attachment-size-span">0 __MSG_bytesLabel__</span>)</div>
                    <button type="button" id="extract-selected-button">__MSG_extensionName__</button>
                </div>
                <div id="attachment-list-div"></div>
            </div>
        </div>
    </section>

    <div id="zoom-overlay" class="modal-overlay hidden">
        <img id="zoom-image" title="__MSG_closeZoomMessage__" src="" />
    </div>

    <div id="zip-overlay" class="modal-overlay hidden">
        <div id="zip-panel">
            <div id="zip-panel-header">
                <div id="zip-attachment-context-div">
                    <div id="zip-account-name-label"></div>
                    <div id="zip-attachment-context-span" class="hidden"><span id="zip-folder-name-span"></span><span id="zip-subfolders-span" class="hidden"> (+ __MSG_subfolders__)</span></div>
                </div>
                <div id="zip-spinner-logo-div" class="spinner-logo-div">
                    <img id="zip-logo-img" class="logo-img" src="paperclip_logo.png" />
                </div>
            </div>

            <table>
                <tr>
                    <td>
                        <div class="zip-operation-label">__MSG_discovering__</div>
                        <progress id="immediate-discovery-progress" value="0" max="1"></progress>
                    </td>
                    <td>
                        <div id="discovery-progress-message"></div>
                        <span id="preparation-alterations-span">0</span> __MSG_alterationsIdentified__
                    </td>
                    <td>
                        <div id="discovery-size-label">0 __MSG_bytesLabel__</div>
                        <div>&nbsp;</div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div class="zip-operation-label">__MSG_preparing__</div>
                        <progress id="preparation-progress" value="0" max="1"></progress>
                    </td>
                    <td>
                        <span id="packaging-skipped-span">0</span> __MSG_duplicatesOmitted__
                    </td>
                    <td>
                        <div id="duplicates-size-label">0 __MSG_bytesLabel__</div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div class="zip-operation-label">__MSG_packaging__</div>
                        <progress id="packaging-progress" value="0" max="1"></progress>
                    </td>
                    <td>
                        <span id="packaging-current-span">0</span> __MSG_of__ <span id="packaging-total-span">0</span> __MSG_attachmentsPackaged__
                        <div><span id="packaging-file-current-span">0</span> __MSG_of__ <span id="packaging-file-total-span">0</span> __MSG_packageFilesSaved__</div>
                    </td>
                    <td>
                        <span id="packaging-size-span">0 __MSG_bytesLabel__</span>
                        <div>&nbsp;</div>
                    </td>
                </tr>
                <tr id="detach-operation-row" class="hidden">
                    <td>
                        <div class="zip-operation-label">__MSG_permanentlyDetach__</div>
                        <progress id="detachment-progress" value="0" max="1"></progress>
                    </td>
                    <td>
                        <div><span id="permanent-detach-current-span">0</span> __MSG_of__ <span id="permanent-detach-total-span">0</span> __MSG_detached__</div>
                        <span id="permanent-detach-nested-count-span">0</span> __MSG_nestedAttachmentsOmitted__
                    </td>
                    <td>&nbsp;</td>
                </tr>
            </table>

            <div id="last-filename-div" class="last-filename-div">...</div>

            <div id="save-result-div">
                <div id="save-result-border-div"></div>
                <div class="save-result-content-div">
                    <div class="zip-operation-label">__MSG_result__</div>
                    <span id="save-result-label"></span>
                    <div><span id="packaging-error-count-span">0</span> __MSG_errorsEncountered__</div>
                </div>
                <div class="result-button-container save-result-content-div">
                    <button id="permanently-detach-button" class="permanently-detach-container close-button disablable" disabled="disabled"><img class="hazard-image" src="hazard-sign.png" /> __MSG_permanentlyDetach__</button>
                    <button id="view-report-button" class="close-button hidden">__MSG_viewReport__</button>                       
                    <button id="close-zip-panel-button" class="close-button disablable" disabled="disabled">__MSG_close__</button>
                    <button id="exit-extension-button" class="close-button disablable" disabled="disabled">__MSG_closeAndExit__</button>
                </div>
            </div>

            <div id="zip-detach-panel-body" class="hidden">
                <div class="zip-operation-label permanently-detach-container"><img class="hazard-image" src="hazard-sign.png" /> __MSG_permanentlyDetach__</div>
                <div id="detach-warning-message">__MSG_permanentDetachWarning__</div>
                <div id="detach-action-buttons-div">
                    <button id="proceed-detach-button" class="close-button">__MSG_proceed__</button>
                    <button id="cancel-detach-button" class="close-button">__MSG_cancel__</button>
                </div>
            </div>

            <div id="detach-result-div" class="hidden">
                <div id="detach-result-border-div"></div>
                <div class="save-result-content-div">
                    <div class="zip-operation-label">__MSG_result__</div>
                    <span id="detach-result-label"></span>
                    <div><span id="detach-error-count-span">0</span> __MSG_errorsEncountered__</div>
                </div>
                <div class="result-button-container save-result-content-div">
                    <button id="view-report-button" class="close-button hidden">__MSG_viewReport__</button>                       
                    <button id="detach-exit-extension-button" class="close-button disablable" disabled="disabled">__MSG_closeAndExit__</button>
                </div>
            </div>

        </div>
    </div>    
    
    <template id="folder-stats-template">
        <tr class="message-stats-tr">
            <td><input type="checkbox" class="folder-checkbox" checked="checked" /></td>
            <td class="folder-td"><span class="spacer"></span><button type="button" class="folder-selector-button"></button></td>

            <td class="message-count-td">0</td>
            <td class="processed-message-count-td">0</td>
            <td class="attachment-message-count-td">0</td>

            <td class="attachment-count-td">0</td>
            <td class="attachment-size-td"></td>
        </tr>
    </template>

    <template id="attachment-grouping-header-template">
        <div class="attachment-grouping-header"><label><input type="checkbox" class="attachment-grouping-checkbox" checked="checked" /> <span class="grouping-key-span"></span></label></div>
    </template> 
    
    <template id="attachment-panel-template">
        <div class="attachment-panel">
            <input type="checkbox" class="attachment-checkbox" message-id="" part-name="" file-size="" timestamp="" extension="" checked="checked" />
            <div class="extension-label"></div>
            <div class="file-name-label"></div>
            <div class="author-label"></div>
            <div class="subject-label"></div>
            <div class="file-size-label"></div>
            <div class="message-date-label"></div>
            <div class="preview-wrapper">
                <img class="preview-image hidden" alt="" />
            </div>
        </div>
    </template>

    <script src="/module/i18n.js"></script>
    <script type="module" src="/module/optionsmanager.js"></script>
<!--    <script src="/module/z-worker.js"></script>     -->
    <script src="/module/zip-full.js"></script>
    <script type="module" src="/module/zipem.js"></script>
    <script type="module" src="/module/embedmanager.js"></script>
    <script type="module" src="/module/attachmentmanager.js"></script>
    <script type="module" src="extractem.js"></script>
</body>
</html>